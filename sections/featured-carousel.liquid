{% comment %}
Featured product carousel
For settings go to Admin -> Theme -> Customize Theme -> Home page
{% endcomment %}

<h1 style="text-align: center;">Newest Products</h1>
<div class="carousel__navigation" style="width: 10%;float: left;">
  <!-- Add Arrows -->
  <div class="homepage-swiper-btn-prev carousel-button-prev">
    <img style="float:right;" src="{{ 'icon_arrow_left.png' | asset_url}}">
  </div>
</div>
<!-- Swiper -->
<div class="swiper-container carousel carousel--homepage" style="width:80%; float:left;">
  <div class="swiper-wrapper">
    {% for product in collections[section.settings.featured_collection].products %}
      <div class="swiper-slide" data-img-bg="{% if product.featured_image.size > 0 %}{{ product.featured_image | img_url: 'grande'}}{% else %}{{ 'img_no_image.jpg' | asset_url }}{% endif %}">
        {% include 'product-item-grid' %}
      </div>
    {% endfor %}
    <div class="swiper-active-slide"></div>
  </div>

</div>

<div class="carousel__navigation" style="width: 10%;float: right;">
  <!-- Add Arrows -->
  <div class="homepage-swiper-btn-next carousel-button-next">
      <img style="float: left;" src="{{ 'icon_arrow_right.png' | asset_url}}">
  </div>
  <!-- Add Pagination -->
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {

    // Initialize SwiperinitHomepageCarousel
    function initHomepageCarousel() {
      var activeSlideContainer = document.querySelector('.swiper-active-slide');
      // Featured carousel
      var allowLinksClick = true;
      var carouselHomepage = new Swiper('.carousel--homepage', {
        nextButton: '.homepage-swiper-btn-next',
        prevButton: '.homepage-swiper-btn-prev',
        preventClicks: false,
        spaceBetween: 10,
        slidesPerGroup: 6,
        slidesPerView: 6,
        loop: false,
        autoplay: "{{ settings.homepage_featured_auplay }}",
        onInit: function(carouselHomepage) {
          var slideNumber = carouselHomepage.slides.length;
          var bdImage, slideLink;
          activeSlideContainer.textContent = carouselHomepage.activeIndex + 1 + "/" + slideNumber;
    
          for ( var i = 0, max = slideNumber; i < max; i++ ) {
            bdImage = carouselHomepage.slides[i].getAttribute('data-img-bg');
            slideLink = carouselHomepage.slides[i].querySelector('.product__link ');
            slideLink.style.backgroundImage = 'url(' + bdImage + ')';
          }    
        },
        onSlideChangeStart: function(carouselHomepage) {
          var slideNumber = carouselHomepage.slides.length;
          activeSlideContainer.textContent = carouselHomepage.activeIndex + 1 + "/" + slideNumber;
        },
        preloadImages: false,
        lazyLoading: true,
        breakpoints: {
          2048:{
              slidesPerView: 6,
              slidesPerGroup: 6
          },
          1506:{
              slidesPerView: 4,
              slidesPerGroup: 4
          },
          1024: {
            slidesPerView: 3,
            slidesPerGroup: 3
          },
          768: {
            slidesPerView: 2,
            slidesPerGroup: 2
          },
          480: {
            slidesPerView: 1,
            slidesPerGroup: 1
          }
        }
      });
    }
                
    if ( typeof Swiper !== 'undefined' && typeof Swiper === 'function' ) {
      initHomepageCarousel();
    } else {
      require("{{ 'swiper.min.js' | asset_url }}", initHomepageCarousel);
    }
  });
</script>

{% schema %}
  {
    "name": "Feature Collection",
    "settings": [
      {
        "type": "collection",
        "id": "featured_collection",
        "label": "Feature Collection"
      },
      {
        "type": "text",
        "id": "autoplay",
        "label": "Time for changing slides",
        "info": "If this parameter is not specified, autoplay will be disabled"
      }
    ],
	"presets": [
      {
        "name": "Feature Collection",
        "category": "Collections"
      }
    ]
  }
{% endschema %}


      