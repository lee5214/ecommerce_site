{% comment %}
Similar product carousel
For settings go to Admin -> Theme -> Customize Theme -> Product page
{% endcomment %}
{% assign number_of_similar_products_to_show = settings.product_similar_number | plus:1 %}
{% assign current_product = product %}
{% assign current_product_tags = product.tags %}
{% assign product_count = 1 %}

<!-- Swiper -->
<div class="swiper-container carousel carousel--product">
    <div class="swiper-button-prev carousel-button-prev">
        <svg viewBox="0 0 18 18" data-reactid=".2akuon0ef4.1.2.0.0.1.0:$experiences_11.0.1.3.0.0.0.0"><path d="M13.703 16.293a1 1 0 1 1-1.415 1.414l-7.995-8a1 1 0 0 1 0-1.414l7.995-8a1 1 0 1 1 1.415 1.414L6.413 9l7.29 7.293z" data-reactid=".2akuon0ef4.1.2.0.0.1.0:$experiences_11.0.1.3.0.0.0.0.0"></path></svg>
    </div>

    <div class="swiper-wrapper" style="width: 90%;">
    {% comment %}
    Creating slides with similar products by tags
    {% endcomment %}

    {% paginate collections.all.products by 1000 %}
      {% for product in collections.all.products %}
  
          {% for tag in product.tags %}
            {% comment %}
            Compare tags from current product with tag from product from other collections. Also check if it is used once
            {% endcomment %}
            {% if current_product_tags contains tag and double_tag == false %}
  
              {% if product.handle != current_product.handle and product.first_available_variant.sku != settings.cart_special_sku and product_count < number_of_similar_products_to_show %}
  
                <div class="swiper-slide">
                  {% include 'product-item-grid' %}
                </div>
  
                {% assign product_count = product_count | plus:1 %}
                {% assign double_tag = true %}   
  
              {% endif %}               
            {% else %}
              {% assign double_tag = false %}    
            {% endif %}
          {% endfor %}
      {% endfor %}
    {% endpaginate %}

  </div>

    <div class="swiper-button-next carousel-button-next">
        <svg viewBox="0 0 18 18"  data-reactid=".2cplo9u29s0.1.2.0.0.1.0:$experiences_5.0.1.3.2.0.0.0"><path d="M4.293 1.707A1 1 0 1 1 5.708.293l7.995 8a1 1 0 0 1 0 1.414l-7.995 8a1 1 0 1 1-1.415-1.414L11.583 9l-7.29-7.293z" data-reactid=".2cplo9u29s0.1.2.0.0.1.0:$experiences_5.0.1.3.2.0.0.0.0"></path></svg>
        <!--<span class="icon icon--arrow-right"></span>-->
    </div>
  <!-- Add Arrows -->

  <div class="swiper-active-slide"></div>

</div>

